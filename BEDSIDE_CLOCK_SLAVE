/*
Colorduino slave module
displays what it is sent over I2C
REM change ID for each one
*/

#include <Wire.h>
#include <Colorduino.h>

#define X_SIZE 8
#define Y_SIZE 8
#define ID 4

void setup()
{
  Wire.begin(ID);                  // join i2c bus with address #4
  Wire.onReceive(receiveEvent);   // register event
//  Serial.begin(9600);           // start serial for output
  Colorduino.Init();              // initialize the board
  unsigned char whiteBalVal[3] = {36,63,63};
  Colorduino.SetWhiteBal(whiteBalVal);
}

void loop()
{
  delay(10);//just to fill the time
}

// function that executes whenever data is received from master
// this function is registered as an event, see setup()
void receiveEvent(int howMany)
{
  while(Wire.available()) // loop through all
  {
//Fill the array	
	for(int x = 0; x < X_SIZE; x++)
	{
	  for(int y = 0; y < Y_SIZE; y++)
	  {
	    unsigned char r = Wire.read(); // receive byte
	    unsigned char g = Wire.read(); // receive byte
	    unsigned char b = Wire.read(); // receive byte
	    Colorduino.SetPixel(x, y, r, g, b);
	  }
	}
  }
  Colorduino.FlipPage();//shows it
}
